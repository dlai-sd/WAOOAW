component: "secrets_management_policy"
component_version: "1.0"
component_type: "security_policy"

purpose: "Tenancy, rotation, and access controls for AI keys, integration credentials, and signing keys"

vault:
  implementation: "HashiCorp Vault (HA)"
  namespace_model:
    - platform/root (SYSTEM_AUDIT, signing keys)
    - platform/services/{service}
    - agents/{agent_id}
  access:
    - ai_explorer: "read ai_api_keys only; no write"
    - outside_world_connector: "read integration credentials per integration policy"
    - agents: "no direct vault access"
  replication: "HA with 3 nodes"
  backup: "nightly snapshots + WAL shipping"

key_management:
  ai_api_keys:
    rotation_days: 90
    owner: "ai_explorer"
    scope: "per-model per-tenant"
  integration_credentials:
    rotation_days: 90
    owner: "outside_world_connector"
    scope: "per-integration per-tenant"
  message_bus_signing_keys:
    rotation_days: 60
    owner: "message_bus"
    scope: "per-sender"
  api_gateway_tls:
    rotation_days: 60
    owner: "platform_sre"

secret_delivery:
  pattern: "service fetches on demand with short TTL"
  cache_ttl_seconds: 300
  audit:
    - who_fetched
    - what_path
    - purpose
    - correlation_id

isolation:
  agent_secret_scope: "agents/{agent_id}/*"
  cross_agent_access: "forbidden"
  break_glass:
    approval: "governor"
    audit: "mandatory log with incident code"

encryption:
  at_rest: "AES-256-GCM"
  in_transit: "TLS 1.3"
  envelope_encryption: true

incident_response:
  triggers:
    - suspected_key_leak
    - failed_unseal_attempts
    - unusual_secret_fetch_volume
  actions:
    - rotate_affected_keys
    - suspend_agent_or_service_if_needed
    - notify_governor + vision_guardian

integrations:
  - component_ai_explorer.yml
  - component_outside_world_connector.yml
  - message_bus_framework.yml
  - api_gateway_policy.yml
